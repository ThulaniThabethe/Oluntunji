@model WebApplication1.ViewModels.MonthlyRevenueReportViewModel

@{
    ViewBag.Title = "Monthly Revenue Report - " + Model.ReportMonth + "/" + Model.ReportYear;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h2>@ViewBag.Title</h2>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="@Url.Action("Dashboard", "Revenue")">Revenue Dashboard</a></li>
                    <li class="breadcrumb-item active">Monthly Report</li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- Summary Cards -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <h5 class="card-title">Total Revenue</h5>
                    <h3 class="card-text">@Model.TotalRevenue.ToString("C")</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white">
                <div class="card-body">
                    <h5 class="card-title">Total Orders</h5>
                    <h3 class="card-text">@Model.TotalOrders.ToString("N0")</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <h5 class="card-title">Books Sold</h5>
                    <h3 class="card-text">@Model.TotalBooksSold.ToString("N0")</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-white">
                <div class="card-body">
                    <h5 class="card-title">Average Order Value</h5>
                    <h3 class="card-text">@Model.AverageOrderValue.ToString("C")</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Month over Month Growth -->
    @if (Model.PreviousMonthRevenue > 0)
    {
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Month-over-Month Growth</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>Previous Month Revenue:</strong> @Model.PreviousMonthRevenue.ToString("C")</p>
                                <p><strong>Current Month Revenue:</strong> @Model.TotalRevenue.ToString("C")</p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Growth Rate:</strong> 
                                    <span class="@(Model.MonthOverMonthGrowth >= 0 ? "text-success" : "text-danger")">
                                        @Model.MonthOverMonthGrowth.ToString("P2")
                                    </span>
                                </p>
                                <p><strong>Growth Amount:</strong> 
                                    <span class="@(Model.MonthOverMonthGrowth >= 0 ? "text-success" : "text-danger")">
                                        @((Model.TotalRevenue - Model.PreviousMonthRevenue).ToString("C"))
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }

    <!-- Daily Breakdown Table -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Daily Revenue Breakdown</h5>
                </div>
                <div class="card-body">
                    @if (Model.DailyBreakdown != null && Model.DailyBreakdown.Count > 0)
                    {
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>Day</th>
                                        <th>Revenue</th>
                                        <th>Orders</th>
                                        <th>Average Order Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var day in Model.DailyBreakdown.OrderBy(d => d.Day))
                                    {
                                        <tr>
                                            <td>@day.Day</td>
                                            <td>@day.Revenue.ToString("C")</td>
                                            <td>@day.Orders.ToString("N0")</td>
                                            <td>@day.AverageOrderValue.ToString("C")</td>
                                        </tr>
                                    }
                                </tbody>
                                <tfoot>
                                    <tr class="table-info">
                                        <td><strong>Total</strong></td>
                                        <td><strong>@Model.TotalRevenue.ToString("C")</strong></td>
                                        <td><strong>@Model.TotalOrders.ToString("N0")</strong></td>
                                        <td><strong>@Model.AverageOrderValue.ToString("C")</strong></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-info">
                            <p>No daily breakdown data available for this month.</p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Revenue Data Table -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Revenue Data Details</h5>
                </div>
                <div class="card-body">
                    @if (Model.RevenueData != null && Model.RevenueData.Count > 0)
                    {
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Total Revenue</th>
                                        <th>Orders</th>
                                        <th>Books Sold</th>
                                        <th>Average Order Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model.RevenueData.OrderBy(r => r.Date))
                                    {
                                        <tr>
                                            <td>@item.Date.ToString("MM/dd/yyyy")</td>
                                            <td>@item.TotalRevenue.ToString("C")</td>
                                            <td>@item.NumberOfOrders.ToString("N0")</td>
                                            <td>@item.NumberOfBooksSold.ToString("N0")</td>
                                            <td>@item.AverageOrderValue.ToString("C")</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-warning">
                            <p>No revenue data available for this month.</p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="btn-group" role="group">
                <a href="@Url.Action("MonthlyReport", "Revenue", new { year = Model.ReportYear, month = Model.ReportMonth - 1 })" 
                   class="btn btn-outline-secondary" 
                   @(Model.ReportMonth == 1 ? "disabled" : "")>
                    <i class="fas fa-chevron-left"></i> Previous Month
                </a>
                <a href="@Url.Action("MonthlyReport", "Revenue", new { year = Model.ReportYear, month = Model.ReportMonth + 1 })" 
                   class="btn btn-outline-secondary" 
                   @(Model.ReportMonth == 12 ? "disabled" : "")>
                    Next Month <i class="fas fa-chevron-right"></i>
                </a>
                <a href="@Url.Action("Reports", "Revenue")" class="btn btn-outline-primary">
                    <i class="fas fa-chart-line"></i> Back to Reports
                </a>
                <a href="@Url.Action("Dashboard", "Revenue")" class="btn btn-outline-info">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Chart scripts removed - DailyBreakdown data structure doesn't match chart requirements
        // Additional data properties would be needed for charts
    </script>
}